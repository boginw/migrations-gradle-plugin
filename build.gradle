plugins {
    id "com.gradle.plugin-publish" version "0.21.0"
    id "java-gradle-plugin"
    id "com.github.johnrengelman.shadow" version "7.1.2"
}

group "com.github.boginw"
version "0.3.0-SNAPSHOT"

repositories {
    mavenCentral()
}

java {
    toolchain {
        languageVersion.set(JavaLanguageVersion.of(11))
    }
}

gradlePlugin {
    plugins {
        migrationsPlugin {
            id = "com.github.boginw.mybatis-migrations"
            implementationClass = "com.github.boginw.mybatis_migrations.MigrationsPlugin"
        }
    }
}

pluginBundle {
    website = "https://github.com/boginw/migrations-gradle-plugin"
    vcsUrl = "https://github.com/boginw/migrations-gradle-plugin"
    description = "Run MyBatis Migrations commands through Gradle"
    plugins {
        migrationsPlugin {
            displayName = "MyBatis Migrations Plugin"
            tags = ["tool", "database", "mybatis", "migrations"]
            version = "0.3.0"
        }
    }

    mavenCoordinates {
        groupId = "com.github.boginw"
        artifactId = "mybatis-migrations"
        version = "0.3.0"
    }
}

dependencies {
    compileOnly(gradleApi())
    testImplementation gradleTestKit()
    implementation "org.mybatis:mybatis-migrations:3.3.10"
    testImplementation platform("org.junit:junit-bom:5.9.0")
    testImplementation "org.junit.jupiter:junit-jupiter-api"
    testRuntimeOnly "org.junit.jupiter:junit-jupiter-engine"
    testImplementation 'org.mockito:mockito-core:4.6.1'
}

tasks.withType(Test).configureEach {
    useJUnitPlatform()
}
